<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Days by Diet</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #2a2a2a;
            color: #ffffff;
            padding: 15px;
            line-height: 1.4;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
        }

        /* MOBILE RESPONSIVE */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                grid-template-columns: 1fr;
                gap: 25px;
            }
            
            .right-column {
                padding-left: 0;
                margin-left: 0;
            }
            
            .left-column, .right-column {
                padding-left: 0;
                padding-right: 0;
            }
        }

        .section-title {
            font-family: 'Georgia', serif;
            font-size: 14px;
            font-weight: bold;
            letter-spacing: 0.5px;
            margin-bottom: 15px;
            color: #ffffff;
        }

        /* MOBILE: Larger title text */
        @media (max-width: 768px) {
            .section-title {
                font-size: 16px;
                margin-bottom: 20px;
                text-align: center;
            }
        }

        .table-container {
            background-color: #2a2a2a;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        /* MOBILE: Match annual table sizing */
        @media (max-width: 768px) {
            table {
                font-size: 12px;
            }
        }

        th {
            background-color: #3a3a3a;
            padding: 8px 12px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #4a4a4a;
            font-size: 12px;
        }

        /* MOBILE: Match annual table header sizing */
        @media (max-width: 768px) {
            th {
                font-size: 12px;
                padding: 12px 6px;
                text-align: center;
            }
        }

        td {
            padding: 6px 12px;
            border: 1px solid #4a4a4a;
            background-color: #2a2a2a;
        }

        /* MOBILE: Match annual table cell sizing */
        @media (max-width: 768px) {
            td {
                padding: 10px 6px;
                text-align: center;
                font-size: 12px;
            }
        }

        .food-item-input {
            background: transparent;
            border: none;
            color: #ffffff;
            width: 100%;
            font-size: 13px;
            outline: none;
            font-family: 'Poppins', sans-serif;
            padding: 4px 0;
        }

        /* MOBILE: Match annual table input sizing */
        @media (max-width: 768px) {
            .food-item-input {
                font-size: 13px;
                padding: 4px;
                min-height: 40px;
                text-align: left;
            }
        }

        .points-cell {
            width: 80px;
            text-align: center;
            color: #ffffff;
        }

        /* MOBILE: Slightly wider points column */
        @media (max-width: 768px) {
            .points-cell {
                width: 90px;
            }
        }

        .meal-header {
            background-color: #2a2a2a;
            font-weight: bold;
            color: #ffffff;
            font-size: 13px;
        }

        /* MOBILE: Match table sizing */
        @media (max-width: 768px) {
            .meal-header {
                font-size: 12px;
            }
        }

        .meal-header input {
            background: transparent;
            border: none;
            color: #ffffff;
            font-weight: bold;
            width: 100%;
            outline: none;
            font-family: 'Poppins', sans-serif;
            font-size: 13px;
            cursor: default;
            user-select: none;
        }

        .meal-header input:read-only {
            pointer-events: none;
            opacity: 1;
        }

        /* MOBILE: Match table sizing */
        @media (max-width: 768px) {
            .meal-header input {
                font-size: 12px;
                min-height: 40px;
                padding: 4px;
            }
        }

        .calculate-button {
            background-color: #660000;
            color: white;
            border: none;
            padding: 8px 16px;
            font-size: 13px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            letter-spacing: 0.5px;
            border-radius: 4px;
        }

        /* MOBILE: Much larger, more touch-friendly button */
        @media (max-width: 768px) {
            .calculate-button {
                width: 100%;
                padding: 16px 20px;
                font-size: 16px;
                margin-top: 20px;
                min-height: 50px;
            }
        }

        .calculate-button:hover {
            background-color: #aa0000;
        }

        .total-row {
            background-color: #2a2a2a;
            font-weight: bold;
        }

        .annual-table {
            margin-top: 0px;
        }

        .annual-table th {
            font-size: 12px;
            padding: 8px 12px;
        }

        /* MOBILE: Responsive annual table */
        @media (max-width: 768px) {
            .annual-table th {
                font-size: 12px;
                padding: 12px 6px;
                text-align: center;
            }
        }

        .annual-table td {
            font-size: 11px;
            padding: 4px 8px;
        }

        /* MOBILE: Larger annual table text */
        @media (max-width: 768px) {
            .annual-table td {
                font-size: 12px;
                padding: 10px 6px;
                text-align: center;
            }
        }


        .summary {
            margin-top: 15px;
            font-size: 12px;
        }

        /* MOBILE: Larger summary text */
        @media (max-width: 768px) {
            .summary {
                font-size: 14px;
                margin-top: 20px;
            }
        }

        .summary ul {
            list-style: none;
            padding-left: 20px;
        }

        .summary li:before {
            content: "• ";
            margin-right: 5px;
        }

        .right-column {
            padding-left: 20px;
        }
        
        /* MOBILE: Remove right column padding */
        @media (max-width: 768px) {
            .right-column {
                padding-left: 0 !important;
            }
        }

        .daily-score, .annual-total, .equivalent-time {
            text-align: center;
        }

        .empty-cell {
            color: #666;
        }

        /* MOBILE: Better spacing for annual calculations table */
        @media (max-width: 768px) {
            .annual-table {
                font-size: 11px;
            }
            
            .annual-table th:last-child {
                font-size: 10px;
            }
        }

        /* MOBILE: Consistent table container styling */
        @media (max-width: 768px) {
            .table-container {
                overflow-x: auto;
                margin: 0;
                padding: 0;
            }
            
            table {
                min-width: 100%;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Left Column - Food Entry -->
        <div class="left-column">
            <h1 class="section-title">DIET IN LAST 32 HOURS</h1>
            <div class="table-container">
                <table id="foodTable">
                    <thead>
                        <tr>
                            <th>Food Item</th>
                            <th>Minutes</th>
                        </tr>
                    </thead>
                    <tbody id="foodTableBody">
                        <tr class="meal-header">
                            <td><input type="text" class="food-item-input" value="BREAKFAST" style="font-weight: bold;" readonly></td>
                            <td class="points-cell"></td>
                        </tr>
                        <tr>
                            <td><input type="text" class="food-item-input" placeholder="Enter food item..."></td>
                            <td class="points-cell"></td>
                        </tr>
                        <tr class="meal-header">
                            <td><input type="text" class="food-item-input" value="LUNCH" style="font-weight: bold;" readonly></td>
                            <td class="points-cell"></td>
                        </tr>
                        <tr>
                            <td><input type="text" class="food-item-input" placeholder=""></td>
                            <td class="points-cell"></td>
                        </tr>
                        <tr class="meal-header">
                            <td><input type="text" class="food-item-input" value="DINNER" style="font-weight: bold;" readonly></td>
                            <td class="points-cell"></td>
                        </tr>
                        <tr>
                            <td><input type="text" class="food-item-input" placeholder=""></td>
                            <td class="points-cell"></td>
                        </tr>
                        <tr class="meal-header">
                            <td><input type="text" class="food-item-input" value="SNACKS, SUPPLEMENTS, EXTRA" style="font-weight: bold;" readonly></td>
                            <td class="points-cell"></td>
                        </tr>
                        <tr>
                            <td><input type="text" class="food-item-input" placeholder=""></td>
                            <td class="points-cell"></td>
                        </tr>
                    </tbody>
                </table>
                <button class="calculate-button" onclick="calculateTotal()">CALCULATE TOTAL</button>
            </div>
        </div>

        <!-- Right Column - Annual Calculations -->
        <div class="right-column">
            <h1 class="section-title">ANNUAL LIFE MINUTES CALCULATION:</h1>
            <div class="table-container">
                <table class="annual-table">
                    <thead>
                        <tr>
                            <th>Daily</th>
                            <th>Weekly</th>
                            <th>Monthly</th>
                            <th>Annual Total</th>
                            <th>Equivalent Time</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="daily-score" id="dailyScore"></td>
                            <td class="weekly-score" id="weeklyScore"></td>
                            <td class="monthly-score" id="monthlyScore"></td>
                            <td class="annual-total" id="annualTotal"></td>
                            <td class="equivalent-time" id="equivalentTime"></td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="summary">
                    <strong>Summary:</strong>
                    <ul id="summaryList">
                        <!-- Summary will be populated after calculation -->
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // EXPANDED FOOD DATABASE WITH USER INPUT ANALYSIS
        // Updated based on real user data patterns from Days by Diet
        const foodDatabase = {
            // ULTRA-PROCESSED FOODS (negative points)
            'hot dog': -36, 'hot dogs': -36,
            'soft drink': -12, 'soft drinks': -12, 'soda': -12, 'coke': -12, 'pepsi': -12,
            'diet coke': -6, 'coke zero': -6, 'diet soda': -6, 'coke zero sugar': -6,
            'cheeseburger': -9, 'hamburger': -8, 'burger': -8,
            'french fries': -8, 'fries': -8, 'chips': -5,
            'pizza': -7, 'frozen pizza': -8,
            'candy': -6, 'chocolate bar': -5, 'milk chocolate': -4,
            'ice cream': -6, 'gelato': -5, 'ice cream for dessert': -6, 'ice cream for desert': -6,
            'cookies': -5, 'biscuits': -4,
            'cake': -5, 'cupcake': -4,
            'donut': -5, 'doughnut': -5, 'muffin': -4, 'banana muffin': -4,
            'white bread': -3, 'processed bread': -3, 'toast': -2, 'jam on toast': -4,
            'processed meat': -8, 'bacon': -6, 'sausage': -6, 'salami': -5,
            'energy drink': -8, 'red bull': -8,
            'instant noodles': -3, 'ramen': -3,

            // AUSTRALIAN/REGIONAL SPECIFIC ITEMS
            'weetbix': -2, 'weet-bix': -2, 'weetabix': -2,
            'vegemite': 0, 'marmite': 0,
            'tim tams': -5, 'lamingtons': -4,
            'meat pie': -6, 'sausage roll': -5,
            'long black': 1, 'flat white': 0, 'cappuccino': -1,

            // COMBINATION FOODS & MEALS
            'spaghetti bolognese': -3, 'spag bol': -3, 'pasta bolognese': -3,
            'fried rice': -1, 'chicken fried rice': -1, 'vegetable fried rice': 0,
            'green curry': 2, 'red curry': 1, 'thai curry': 1,
            'fish and chips': -8, 'bangers and mash': -7,
            'steak and vegetables': 2, 'steak & roast veg': 2, 'steak & roast vegs': 2,
            'chicken and rice': 1, 'beef stir fry': 1,
            'caesar salad': 2, 'garden salad': 4, 'greek salad': 3,
            'chicken sandwich': -2, 'ham sandwich': -3, 'tuna sandwich': 0,

            // BRANDED SNACKS & CRACKERS
            'rice crackers': -1, 'water crackers': -2, 'crackers': -2,
            'cheese and crackers': -2, 'biscuits and cheese': -2,
            'rice cakes': -1, 'corn chips': -4, 'potato chips': -5,
            'pretzels': -2, 'popcorn': -1,

            // SPREADS & CONDIMENTS
            'jam': -3, 'jelly': -3, 'marmalade': -3,
            'peanut butter': 1, 'almond butter': 2, 'tahini': 2,
            'nutella': -4, 'honey': -1, 'maple syrup': -2,
            'tomato sauce': -2, 'ketchup': -3, 'bbq sauce': -3,
            'mayo': -2, 'mayonnaise': -2, 'mustard': 0,

            // HEALTHY FOODS (positive points)
            'leafy greens': 8, 'spinach': 8, 'kale': 8, 'arugula': 8, 'lettuce': 6,
            'berries': 7, 'blueberries': 7, 'strawberries': 7, 'raspberries': 7, 'blackberries': 7,
            'nuts': 6, 'almonds': 6, 'walnuts': 6, 'pistachios': 6, 'pistachio nuts': 6, 'pecans': 5,
            'salmon': 6, 'fish': 5, 'tuna': 5, 'sardines': 6, 'mackerel': 6,
            'avocado': 5, 'olive oil': 4, 'extra virgin olive oil': 5,
            'beans': 5, 'lentils': 5, 'chickpeas': 4, 'black beans': 5, 'can of beans': 5,
            'quinoa': 4, 'brown rice': 2, 'wild rice': 3, 'cup of rice': 1,
            'sweet potato': 4, 'yam': 3, 'potato': 1, 'mashed potato': -1, 'mash potato': -1,
            'broccoli': 5, 'cauliflower': 4, 'brussels sprouts': 4, 'sprouts': 4, 'half cup sprouts': 4,
            'tomatoes': 3, 'cherry tomatoes': 3,
            'carrots': 3, 'carrot': 3, 'half a carrot': 3, 'bell peppers': 2, 'capsicum': 2,
            'cucumber': 2, '1 cucumber': 2, 'celery': 2, 'onion': 1,
            'apple': 3, 'banana': 2, 'orange': 3, 'grapefruit': 3, 'fruit': 2, 'bits of fruit': 2,
            'greek yogurt': 4, 'plain yogurt': 3, 'kefir': 4, 'yogurt': 2,
            'eggs': 3, 'egg whites': 2, 'boiled eggs': 3, '2 boiled eggs': 3, 'boiled eggs with chili oil': 3,
            'chicken breast': 3, 'turkey': 3, 'lean beef': 2, 'chicken thigh': 2, 'roast chicken thigh': 2,
            'brisket': 2, 'steak': 2, 'ground beef': 1, '3 pieces steak': 2, 'slowcooked brisket': 3,
            'oatmeal': 3, 'steel cut oats': 4, 'porridge': 2,
            'green tea': 2, 'herbal tea': 1, 'tea': 1,
            'coffee': 1, 'black coffee': 1, '2 coffees': 1, 'coffee with milk': 0, 'coffee with cream': -1,
            'dark chocolate': 2, '85% dark chocolate': 3, 'dark chocolate 80%': 3,
            'kimchi': 3, 'sauerkraut': 2,
            'garlic': 1, 'ginger': 1,

            // CHEESE VARIETIES
            'cheese': -1, 'cheddar cheese': -1.4, 'mozzarella': -1, 'feta': 0, 'cream cheese': -2,
            'cottage cheese': 1, 'ricotta': 0, 'parmesan': -1, 'blue cheese': -2,

            // NEUTRAL/MIXED FOODS
            'white rice': -0.5, 'pasta': -0.5, 'whole wheat pasta': 1, 'rice': 0,
            'milk': 0, 'whole milk': 0, 'skim milk': 1, '100ml milk': 0,
            'butter': -2, 'margarine': -3,
            'bread': -2, 'whole grain bread': 1, 'sourdough': -1,

            // BEVERAGES WITH DOSE-RESPONSE
            'red wine': 2, 'white wine': 1, 'wine': 2, '2 glasses of red wine': 2,
            'beer': -2, 'light beer': -1,
            'whiskey': -3, 'vodka': -3, 'gin': -3,
            'water': 0.5, '500ml water': 0.5, 'sparkling water': 0.5,

            // COOKING METHODS & PREPARATIONS
            'fried': -2, 'deep fried': -4, 'grilled': 1, 'roasted': 1, 'steamed': 2,
            'boiled': 1, 'baked': 0, 'raw': 2, 'fresh': 1,

            // SUPPLEMENTS & VITAMINS (positive points)
            'fish oil': 4, 'omega 3': 4, 'omega-3': 4,
            'vitamin d': 3, 'vitamin d3': 3, 'vit d': 3,
            'vitamin c': 2, 'vit c': 2, 'magnesium': 1, 'zinc': 1,
            'probiotics': 3, 'multivitamin': 2,
            'iron': 1, 'calcium': 1, 'vitamin b12': 2, 'vit b12': 2,
            'folate': 1, 'folic acid': 1, 'biotin': 1,
            'vitamin e': 1, 'vit e': 1, 'coq10': 2, 'turmeric': 2,
            'curcumin': 2, 'ashwagandha': 1, 'echinacea': 1,
            'andrographis': 1, 'iodine': 1, 'creatine': 1, '5g creatine': 1,
            'vitamin k2': 2, 'vit k2': 2, 'vitamin k': 2,

            // SPECIALTY HEALTH ITEMS
            'protein powder': 2, 'whey protein': 2, 'protein shake': 2,
            'coconut oil': 1, 'mct oil': 2, 'flax seeds': 3, 'chia seeds': 4,
            'spirulina': 4, 'chlorella': 3, 'nutritional yeast': 2,
            'apple cider vinegar': 1, 'kombucha': 2,

            // TREATS & DESSERTS
            'chocolate': -2, 'candy bar': -5, 'lollies': -5,
            'bliss balls': 1, '2 bliss balls': 1, 'energy balls': 1,
            'fruit salad': 4, 'smoothie': 2, 'green smoothie': 4,

            // DUMPLINGS & ASIAN FOODS
            'dumplings': -2, '2 dumplings': -2, 'steamed dumplings': -1,
            'spring rolls': -3, 'sushi': 1, 'miso soup': 2,
            'noodles': -1, 'rice noodles': -1, 'soba noodles': 0,

            // BREAKFAST CEREALS
            'cereal': -3, 'muesli': 0, 'granola': -1, 'corn flakes': -3,
            'special k': -2, 'all bran': 1, 'oat bran': 2,

            // ADDITIONAL SEASONINGS & ADDITIVES
            'salt': -1, 'sea salt': 0, 'seasalt': 0, 'baking soda': 0,
            'herbs': 1, 'spices': 1, 'pepper': 0, 'chili': 1,

            // PORTION-SPECIFIC ENTRIES
            'bowl of': 1, 'cup of': 1, 'glass of': 1, 'piece of': 1,
            'serving of': 1, 'portion of': 1, 'handful of': 1,

            // RESTAURANT/TAKEAWAY ITEMS
            'mcdonalds': -8, 'kfc': -8, 'subway': -3, 'pizza hut': -7,
            'chinese takeaway': -3, 'fish and chips shop': -6,
            'thai food': 1, 'japanese food': 2, 'mediterranean food': 4
        };

        // ENHANCED DOSE-RESPONSE CURVES (from original system)
        const doseResponseRules = {
            'red wine': { beneficial: 1, neutral: 2, harmful: 3, maxBenefit: 2, penalty: -4 },
            'white wine': { beneficial: 1, neutral: 2, harmful: 3, maxBenefit: 1, penalty: -3 },
            'wine': { beneficial: 1, neutral: 2, harmful: 3, maxBenefit: 2, penalty: -4 },
            'coffee': { beneficial: 3, neutral: 4, harmful: 6, maxBenefit: 3, penalty: -1 },
            'black coffee': { beneficial: 3, neutral: 4, harmful: 6, maxBenefit: 3, penalty: -1 },
            'coffee with milk': { beneficial: 2, neutral: 3, harmful: 5, maxBenefit: 2, penalty: -1 },
            'coffee with cream': { beneficial: 1, neutral: 2, harmful: 4, maxBenefit: 1, penalty: -2 },
            'green tea': { beneficial: 5, neutral: 8, harmful: 12, maxBenefit: 10, penalty: -0.5 },
            'dark chocolate': { beneficial: 2, neutral: 4, harmful: 8, maxBenefit: 4, penalty: -2 },
            'nuts': { beneficial: 3, neutral: 6, harmful: 10, maxBenefit: 6, penalty: -1 },
            'beer': { beneficial: 0, neutral: 1, harmful: 2, maxBenefit: -1, penalty: -3 }
        };

        // ENHANCED PORTION SIZE MULTIPLIERS
        const portionMultipliers = {
            // Weight units (per 100g base)
            'g': 0.01, 'gram': 0.01, 'grams': 0.01,
            'kg': 10, 'kilogram': 10, 'kilograms': 10,
            'oz': 0.28, 'ounce': 0.28, 'ounces': 0.28,
            'lb': 4.5, 'pound': 4.5, 'pounds': 4.5,
            
            // Volume units (per standard serving)
            'ml': 0.004, 'milliliter': 0.004, 'milliliters': 0.004,
            'l': 4, 'liter': 4, 'liters': 4, 'litre': 4, 'litres': 4,
            'cup': 1, 'cups': 1, 'cup of': 1, 'cups of': 1,
            'glass': 1, 'glasses': 1, 'glass of': 1, 'glasses of': 1,
            'bottle': 3, 'bottles': 3,
            'can': 1, 'cans': 1, 'can of': 1,
            'bowl': 1.5, 'bowls': 1.5, 'bowl of': 1.5,
            'tbsp': 0.25, 'tablespoon': 0.25, 'tablespoons': 0.25,
            'tsp': 0.08, 'teaspoon': 0.08, 'teaspoons': 0.08,
            
            // Count units
            'x': 1, '×': 1, 'piece': 1, 'pieces': 1, 'piece of': 1, 'pieces of': 1,
            'slice': 0.5, 'slices': 0.5,
            'serving': 1, 'servings': 1, 'serving of': 1,
            'handful': 1, 'handfuls': 1, 'handful of': 1,
            'bit': 0.3, 'bits': 0.3, 'bits of': 0.3,
            'half': 0.5, 'quarter': 0.25,
            
            // Common portion descriptors
            'small': 0.75, 'medium': 1, 'large': 1.5, 'extra large': 2,
            'mini': 0.5, 'regular': 1, 'king size': 2
        };

        let calculationDone = false;
        let initialInputValues = new Map(); // Track initial values when inputs are focused

        function addNewRowAfter(currentRow) {
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" class="food-item-input" placeholder=""></td>
                <td class="points-cell"></td>
            `;
            
            // Insert the new row after the current row
            currentRow.parentNode.insertBefore(newRow, currentRow.nextSibling);
            
            // Add event listeners to the new input - unified for all devices
            const newInput = newRow.querySelector('.food-item-input');
            newInput.addEventListener('input', handleUnifiedInput);
            newInput.addEventListener('keypress', handleKeyPress);
            newInput.addEventListener('focus', handleInputFocus);
            
            // Additional events for mobile compatibility
            newInput.addEventListener('keyup', handleUnifiedInput);
            newInput.addEventListener('change', handleUnifiedInput);
            newInput.addEventListener('paste', handleUnifiedInput);
            
            // Samsung/Android specific events for "Next" button behavior
            newInput.addEventListener('blur', handleUnifiedInput);
            newInput.addEventListener('focusout', handleUnifiedInput);
            
            // Input method editor events (for virtual keyboards)
            newInput.addEventListener('compositionend', handleUnifiedInput);
            newInput.addEventListener('textInput', handleUnifiedInput);
            
            // Special handler for Samsung "Next" button behavior
            newInput.addEventListener('blur', function(e) {
                // When focus leaves an input (like hitting "Next"), check immediately
                setTimeout(() => {
                    const currentValue = e.target.value.trim();
                    const currentRow = e.target.closest('tr');
                    const inputKey = getInputKey(e.target);
                    const initialValue = initialInputValues.get(inputKey) || '';
                    
                    // Only add row if this was a new entry (initial value was empty)
                    if (currentValue && initialValue === '' && !currentRow.classList.contains('meal-header') && !hasEmptyRowAfter(currentRow)) {
                        addNewRowAfter(currentRow);
                    }
                }, 50);
            });
            
            return newRow;
        }

        // Unified input handler for all devices - simple and reliable
        function handleUnifiedInput(event) {
            const input = event.target;
            const currentRow = input.closest('tr');
            
            // Don't process meal headers
            if (currentRow.classList.contains('meal-header')) {
                return;
            }
            
            // Use a small delay to ensure the input value is fully captured
            // This works for both desktop and mobile
            setTimeout(() => {
                const currentValue = input.value.trim();
                const inputKey = getInputKey(input);
                const initialValue = initialInputValues.get(inputKey) || '';
                
                // Only add new row if:
                // 1. Current value has content
                // 2. Initial value was empty (this is a new entry, not editing)
                // 3. No empty row exists after this one
                if (currentValue && initialValue === '' && !hasEmptyRowAfter(currentRow)) {
                    addNewRowAfter(currentRow);
                }
            }, 150); // Increased delay for Samsung virtual keyboard
        }

        // Helper function to get unique key for an input
        function getInputKey(input) {
            const row = input.closest('tr');
            const rowIndex = Array.from(row.parentNode.children).indexOf(row);
            return `row-${rowIndex}`;
        }

        // Track initial value when input gets focus
        function handleInputFocus(event) {
            const input = event.target;
            const inputKey = getInputKey(input);
            const currentValue = input.value.trim();
            
            // Always update the initial value when input is focused
            // This ensures we track the state at the moment of focus
            initialInputValues.set(inputKey, currentValue);
        }

        function hasEmptyRowAfter(currentRow) {
            const nextRow = currentRow.nextElementSibling;
            if (!nextRow) return false;
            
            // If next row is a meal header, we should add an empty row before it
            if (nextRow.classList.contains('meal-header')) return false;
            
            // Check if next row is empty - if it is, we don't need another
            const nextInput = nextRow.querySelector('.food-item-input');
            return nextInput && nextInput.value.trim() === '';
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                const input = event.target;
                const currentRow = input.closest('tr');
                
                // Don't handle Enter for meal headers
                if (currentRow.classList.contains('meal-header')) {
                    return;
                }
                
                let nextRow = currentRow.nextElementSibling;
                
                // If no next row or next row is a meal header, create a new row after current
                if (!nextRow || nextRow.classList.contains('meal-header')) {
                    nextRow = addNewRowAfter(currentRow);
                }
                
                // Focus on the next input
                const nextInput = nextRow.querySelector('.food-item-input');
                if (nextInput) {
                    nextInput.focus();
                }
            }
        }

        // ENHANCED FOOD PARSING FUNCTION
        function parseFood(input) {
            if (!input || typeof input !== 'string') return null;
            
            const cleanInput = input.toLowerCase().trim();
            
            // Pattern to match quantity + unit + food
            const quantityPattern = /^(\d+\.?\d*)\s*(x|×|g|grams?|kg|kilograms?|oz|ounces?|lb|pounds?|ml|milliliters?|l|liters?|litres?|cups?|glasses?|bottles?|cans?|tbsp|tablespoons?|tsp|teaspoons?|pieces?|slices?|servings?|handfuls?)\s+(.+)$/i;
            
            // Pattern to match just quantity + food (assume serving)
            const simpleQuantityPattern = /^(\d+\.?\d*)\s+(.+)$/;
            
            let quantity = 1;
            let unit = 'serving';
            let foodName = cleanInput;
            
            const quantityMatch = cleanInput.match(quantityPattern);
            if (quantityMatch) {
                quantity = parseFloat(quantityMatch[1]);
                unit = quantityMatch[2].toLowerCase();
                foodName = quantityMatch[3].trim();
            } else {
                const simpleMatch = cleanInput.match(simpleQuantityPattern);
                if (simpleMatch) {
                    quantity = parseFloat(simpleMatch[1]);
                    foodName = simpleMatch[2].trim();
                }
            }
            
            return { quantity, unit, foodName };
        }

        // FIND FOOD SCORE WITH FUZZY MATCHING
        function findFoodScore(foodItem) {
            if (!foodItem || typeof foodItem !== 'string') return 0;
            
            const item = foodItem.toLowerCase().trim();
            
            // Direct match
            if (foodDatabase[item] !== undefined) {
                return foodDatabase[item];
            }
            
            // Partial match - check if any database key is contained in the input
            for (const [key, value] of Object.entries(foodDatabase)) {
                if (item.includes(key) || key.includes(item)) {
                    return value;
                }
            }
            
            // Special handling for common variations
            const variations = {
                'coke zero': -6, 'diet coke': -6, 'zero coke': -6,
                'french toast': -4, 'toast': -2,
                'iced coffee': 1, 'cold brew': 1,
                'protein shake': 2, 'whey protein': 2,
                'green smoothie': 4, 'fruit smoothie': 1,
                'caesar salad': 2, 'garden salad': 4, 'salad': 3
            };
            
            for (const [variation, score] of Object.entries(variations)) {
                if (item.includes(variation) || variation.includes(item)) {
                    return score;
                }
            }
            
            // No match found
            return 0;
        }

        // CALCULATE DOSE-RESPONSE EFFECTS
        function calculateDoseResponse(baseScore, quantity, foodName) {
            const rules = doseResponseRules[foodName];
            if (!rules) return baseScore * quantity;
            
            if (quantity <= rules.beneficial) {
                return baseScore * quantity;
            } else if (quantity <= rules.neutral) {
                return rules.maxBenefit;
            } else {
                const excessAmount = quantity - rules.neutral;
                return rules.maxBenefit + (excessAmount * rules.penalty);
            }
        }

        // ENHANCED FOOD CALCULATION WITH DETAILED BREAKDOWN
        function calculateFoodScore(input) {
            const parsed = parseFood(input);
            if (!parsed) return { score: 0, breakdown: 'Invalid input' };
            
            const { quantity, unit, foodName } = parsed;
            const baseScore = findFoodScore(foodName);
            
            if (baseScore === 0) {
                return { 
                    score: 0, 
                    breakdown: `"${foodName}" not found in database`,
                    confidence: 'unknown'
                };
            }
            
            // Apply portion multiplier
            const portionMultiplier = portionMultipliers[unit] || 1;
            const adjustedQuantity = quantity * portionMultiplier;
            
            // Apply dose-response curve
            const finalScore = Math.round(calculateDoseResponse(baseScore, adjustedQuantity, foodName));
            
            // Create breakdown explanation
            let breakdown = '';
            if (quantity !== 1 || unit !== 'serving') {
                if (doseResponseRules[foodName]) {
                    if (adjustedQuantity <= doseResponseRules[foodName].beneficial) {
                        breakdown = `${quantity} ${unit} - beneficial range`;
                    } else if (adjustedQuantity <= doseResponseRules[foodName].neutral) {
                        breakdown = `${quantity} ${unit} - neutral range (diminishing returns)`;
                    } else {
                        breakdown = `${quantity} ${unit} - excessive (negative effects)`;
                    }
                } else {
                    breakdown = `${quantity} ${unit} × ${baseScore} base minutes`;
                }
            } else {
                breakdown = `Standard serving`;
            }
            
            return {
                score: finalScore,
                breakdown: breakdown,
                confidence: 'verified'
            };
        }

        // REPLACE THE EXISTING calculateTotal() FUNCTION WITH THIS:
        function calculateTotal() {
            const tbody = document.getElementById('foodTableBody');
            const rows = tbody.querySelectorAll('tr');
            let totalPoints = 0;
            let foodCount = 0;
            let detailedBreakdown = [];

            rows.forEach(row => {
                const input = row.querySelector('.food-item-input');
                const pointsCell = row.querySelector('.points-cell');
                const foodInput = input.value.trim();
                
                if (foodInput && !row.classList.contains('meal-header')) {
                    const result = calculateFoodScore(foodInput);
                    
                    if (result.score !== 0) {
                        pointsCell.innerHTML = result.score > 0 ? 
                            `<span style="color: #88cc88;">+${result.score}</span>` : 
                            `<span style="color: #cc8888;">${result.score}</span>`;
                        
                        // Add tooltip with breakdown
                        pointsCell.title = result.breakdown;
                        
                        totalPoints += result.score;
                        foodCount++;
                        
                        detailedBreakdown.push({
                            food: foodInput,
                            score: result.score,
                            breakdown: result.breakdown,
                            confidence: result.confidence
                        });
                    } else {
                        pointsCell.innerHTML = `<span style="color: #666666;">0*</span>`;
                        pointsCell.title = result.breakdown || "Item not recognized";
                    }
                } else if (row.classList.contains('meal-header')) {
                    pointsCell.textContent = '';
                }
            });

            // Add total row if not exists
            let totalRow = tbody.querySelector('.total-row');
            if (!totalRow) {
                totalRow = document.createElement('tr');
                totalRow.classList.add('total-row');
                totalRow.innerHTML = `
                    <td style="font-weight: bold;">TOTAL</td>
                    <td class="points-cell" style="font-weight: bold;"></td>
                `;
                tbody.appendChild(totalRow);
            }

            // Update total with color coding
            const totalCell = totalRow.querySelector('.points-cell');
            const totalColor = totalPoints > 0 ? '#88cc88' : totalPoints < 0 ? '#cc8888' : '#ffffff';
            totalCell.innerHTML = `<span style="color: ${totalColor};">${totalPoints > 0 ? '+' : ''}${totalPoints} LIFE MINUTES</span>`;

            // Update annual calculations
            updateAnnualCalculations(totalPoints);
            
            // Log detailed breakdown for debugging
            console.log('Detailed Food Breakdown:', detailedBreakdown);
            
            calculationDone = true;
        }

        function updateAnnualCalculations(dailyPoints) {
            // Calculate all time periods
            const weeklyPoints = dailyPoints * 7;
            const monthlyPoints = dailyPoints * 30.44; // Average days per month
            const annualPoints = dailyPoints * 365;
            const equivalentDays = Math.round(annualPoints / (24 * 60) * 10) / 10; // Convert to days with 1 decimal
            
            // Update all the cells
            document.getElementById('dailyScore').textContent = `${dailyPoints > 0 ? '+' : ''}${dailyPoints} min`;
            document.getElementById('weeklyScore').textContent = `${weeklyPoints > 0 ? '+' : ''}${Math.round(weeklyPoints)} min`;
            document.getElementById('monthlyScore').textContent = `${monthlyPoints > 0 ? '+' : ''}${Math.round(monthlyPoints)} min`;
            document.getElementById('annualTotal').textContent = `${annualPoints > 0 ? '+' : ''}${annualPoints} min`;
            
            // Format equivalent time
            if (Math.abs(equivalentDays) >= 1) {
                document.getElementById('equivalentTime').textContent = `${equivalentDays > 0 ? '+' : ''}${equivalentDays} ${Math.abs(equivalentDays) === 1 ? 'day' : 'days'}`;
            } else {
                const hours = Math.round(annualPoints / 60 * 10) / 10;
                document.getElementById('equivalentTime').textContent = `${hours > 0 ? '+' : ''}${hours} ${Math.abs(hours) === 1 ? 'hour' : 'hours'}`;
            }

            // Update summary
            const summaryList = document.getElementById('summaryList');
            summaryList.innerHTML = '';
            const summaryItem = document.createElement('li');
            
            if (equivalentDays > 0) {
                summaryItem.textContent = `would gain over ${Math.abs(equivalentDays)} days of life per year`;
            } else if (equivalentDays < 0) {
                summaryItem.textContent = `would lose over ${Math.abs(equivalentDays)} days of life per year`;
            } else {
                summaryItem.textContent = `no significant impact on life expectancy`;
            }
            
            summaryList.appendChild(summaryItem);
        }


        // Add event listeners to existing inputs
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = document.querySelectorAll('.food-item-input');
            inputs.forEach(input => {
                input.addEventListener('input', handleUnifiedInput);
                input.addEventListener('keypress', handleKeyPress);
                input.addEventListener('focus', handleInputFocus);
                
                // Additional events for mobile compatibility
                input.addEventListener('keyup', handleUnifiedInput);
                input.addEventListener('change', handleUnifiedInput);
                input.addEventListener('paste', handleUnifiedInput);
                
                // Samsung/Android specific events for "Next" button behavior
                input.addEventListener('blur', handleUnifiedInput);
                input.addEventListener('focusout', handleUnifiedInput);
                
                // Input method editor events (for virtual keyboards)
                input.addEventListener('compositionend', handleUnifiedInput);
                input.addEventListener('textInput', handleUnifiedInput);
                
                // Special handler for Samsung "Next" button behavior
                input.addEventListener('blur', function(e) {
                    // When focus leaves an input (like hitting "Next"), check immediately
                    setTimeout(() => {
                        const currentValue = e.target.value.trim();
                        const currentRow = e.target.closest('tr');
                        const inputKey = getInputKey(e.target);
                        const initialValue = initialInputValues.get(inputKey) || '';
                        
                        // Only add row if this was a new entry (initial value was empty)
                        if (currentValue && initialValue === '' && !currentRow.classList.contains('meal-header') && !hasEmptyRowAfter(currentRow)) {
                            addNewRowAfter(currentRow);
                        }
                    }, 50);
                });
            });
        });
    </script>

    <!-- LEGAL DISCLOSURES SECTION - Add this before closing </body> tag -->

    <div class="legal-disclosures-section">
        <div class="disclosures-content">
            
            <!-- Main Disclaimer - Always Visible -->
            <div class="primary-disclaimer">
                <h3 class="disclaimer-title">Important Health & Legal Information</h3>
                <div class="disclaimer-text">
                    <strong>Educational Purpose Only:</strong> Days by Diet is designed to raise awareness about how dietary choices may impact long-term health outcomes. This tool provides educational estimates based on epidemiological research and should not be considered medical advice, diagnosis, or treatment recommendations.
                </div>
            </div>

            <!-- Toggle Button -->
            <div class="toggle-button-container">
                <button class="disclosure-toggle" onclick="toggleDisclosure()">
                    <span id="toggleText">View Complete Disclaimer</span>
                    <span class="toggle-arrow" id="toggleArrow">▼</span>
                </button>
            </div>

            <!-- Collapsible Content -->
            <div class="disclosure-content" id="disclosureContent">
                
                <!-- Medical Disclaimer -->
                <div class="medical-disclaimer">
                    <h4 class="section-subtitle">Medical Disclaimer</h4>
                    <div class="disclaimer-text">
                        <strong>Consult Healthcare Professionals:</strong> Always consult with qualified healthcare providers before making significant dietary changes, especially if you have medical conditions, take medications, or have specific health concerns. Individual health needs vary significantly, and this tool cannot account for personal medical history, genetic factors, allergies, or drug interactions.
                        <br><br>
                        <strong>Not a Substitute for Professional Care:</strong> This calculator does not replace professional medical advice, diagnosis, or treatment. If you have health concerns or symptoms, seek immediate medical attention.
                    </div>
                </div>

                <!-- Methodology Transparency -->
                <div class="methodology-disclaimer">
                    <h4 class="section-subtitle">Calculation Methodology</h4>
                    <div class="disclaimer-text">
                        <strong>Research-Based Estimates:</strong> Our "life minutes" calculations are derived from peer-reviewed epidemiological studies examining associations between dietary patterns and health outcomes. These represent population-level statistical associations, not individual predictions.
                        <br><br>
                        <strong>Simplified Model:</strong> This tool provides simplified estimates for educational awareness. Actual health impacts depend on numerous factors including genetics, environment, exercise, stress, sleep, medical history, and overall lifestyle patterns not captured in this calculation.
                    </div>
                </div>

                <!-- Affiliate Disclosure -->
                <div class="affiliate-disclaimer">
                    <h4 class="section-subtitle">Financial Disclosure</h4>
                    <div class="disclaimer-text">
                        <strong>Affiliate Partnerships:</strong> Days by Diet participates in affiliate programs with carefully selected health and nutrition companies including iHerb and Noom. We earn commissions from qualifying purchases made through our links at no additional cost to you.
                        <br><br>
                        <strong>Editorial Independence:</strong> Our recommendations are based on nutritional science and user benefit, not commission rates. We only partner with companies whose products and services align with our mission of promoting genuine health awareness and improvement.
                        <br><br>
                        <strong>Transparency Commitment:</strong> All affiliate relationships are clearly disclosed. Our primary goal is health education; monetization supports keeping this tool free and continuously improving.
                    </div>
                </div>

                <!-- Data & Privacy -->
                <div class="privacy-disclaimer">
                    <h4 class="section-subtitle">Privacy & Data Usage</h4>
                    <div class="disclaimer-text">
                        <strong>No Personal Health Data Storage:</strong> Days by Diet does not store your food entries or personal health information on our servers. All calculations are performed locally in your browser.
                        <br><br>
                        <strong>Analytics & Improvement:</strong> We use aggregated, anonymous usage data to improve the tool's functionality and user experience. No individually identifiable information is collected or shared.
                        <br><br>
                        <strong>Cookie Usage:</strong> This site uses cookies for basic functionality and analytics. Affiliate partners may use cookies to track referrals for commission purposes.
                    </div>
                </div>

                <!-- Limitations -->
                <div class="limitations-disclaimer">
                    <h4 class="section-subtitle">Known Limitations</h4>
                    <div class="disclaimer-text">
                        <strong>Population-Based Data:</strong> Calculations are based on population-level research that may not apply to all individuals, ethnic groups, age ranges, or health conditions.
                        <br><br>
                        <strong>Simplified Nutrition Model:</strong> This tool focuses on specific foods and nutrients with strong research backing. It does not capture the full complexity of nutritional interactions, bioavailability, or individual metabolic differences.
                        <br><br>
                        <strong>Dynamic Research:</strong> Nutritional science evolves continuously. Our calculations reflect current research understanding but may be updated as new evidence emerges.
                    </div>
                </div>

                <!-- Terms of Use Summary -->
                <div class="terms-summary">
                    <h4 class="section-subtitle">Terms of Use Summary</h4>
                    <div class="disclaimer-text">
                        <strong>Acceptance:</strong> By using Days by Diet, you acknowledge understanding these limitations and agree to use this tool for educational awareness purposes only.
                        <br><br>
                        <strong>Liability Limitation:</strong> Days by Diet, its creators, and affiliates are not liable for any health outcomes, medical decisions, or consequences resulting from use of this tool.
                        <br><br>
                        <strong>Age Requirement:</strong> This tool is designed for adults 18 years and older. Nutritional needs for children, adolescents, pregnant or nursing women require specialized professional guidance.
                    </div>
                </div>

                <!-- Contact & Updates -->
                <div class="contact-disclaimer">
                    <h4 class="section-subtitle">Questions & Updates</h4>
                    <div class="disclaimer-text">
                        <strong>Scientific Updates:</strong> As nutrition research evolves, we update our calculations to reflect current scientific consensus. Users are encouraged to check for updates periodically.
                        <br><br>
                        <strong>Feedback Welcome:</strong> We welcome feedback from healthcare professionals and users to improve accuracy and utility while maintaining our educational mission.
                        <br><br>
                        <strong>Contact:</strong> For questions about methodology, partnerships, or suggestions, please contact us through our website.
                    </div>
                </div>

            </div>

        </div>

        <!-- Footer - Always Visible -->
        <div class="footer-section">
            <div class="disclaimer-text" style="text-align: center; font-size: 11px; color: #888888;">
                © 2025 Days by Diet. All rights reserved.
                <br><br>
                <a href="#" onclick="showLegalModal(); return false;" style="color: #888888;">Additional Legal Terms</a> | 
                <a href="#" onclick="showContactModal(); return false;" style="color: #888888;">Contact</a>
                <br><br>
                <em>Last updated: January 2025</em>
            </div>
        </div>
    </div>

    <style>
    /* LEGAL DISCLOSURES STYLING */
    .legal-disclosures-section {
        margin-top: 60px;
        padding: 40px 0;
        background-color: #1a1a1a;
        border-top: 1px solid #3a3a3a;
        text-align: center;
    }

    .disclosures-content {
        max-width: 800px;
        margin: 0 auto;
        padding: 0 20px;
        text-align: center;
    }

    .disclaimer-title {
        font-family: 'Georgia', serif;
        font-size: 18px;
        font-weight: bold;
        color: #ffffff;
        margin-bottom: 15px;
        text-align: center;
        letter-spacing: 0.3px;
    }

    .section-subtitle {
        font-family: 'Georgia', serif;
        font-size: 14px;
        font-weight: bold;
        color: #cccccc;
        margin: 25px 0 10px 0;
        letter-spacing: 0.2px;
        text-align: left;
    }

    .disclaimer-text {
        font-size: 12px;
        color: #aaaaaa;
        line-height: 1.5;
        margin-bottom: 15px;
        text-align: left;
    }

    .disclaimer-text strong {
        color: #cccccc;
        font-weight: 600;
    }

    .primary-disclaimer {
        background-color: #2a2a2a;
        padding: 20px;
        border: 1px solid #4a4a4a;
        border-radius: 4px;
        margin-bottom: 20px;
    }

    .primary-disclaimer .disclaimer-text {
        color: #ffffff;
        font-size: 13px;
        text-align: center;
    }

    /* Toggle Button Styling */
    .toggle-button-container {
        text-align: center;
        margin: 20px 0;
    }

    .disclosure-toggle {
        background-color: #3a3a3a;
        color: #ffffff;
        border: 1px solid #4a4a4a;
        padding: 12px 20px;
        font-size: 12px;
        font-weight: bold;
        cursor: pointer;
        border-radius: 4px;
        font-family: 'Poppins', sans-serif;
        transition: background-color 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
    }

    .disclosure-toggle:hover {
        background-color: #4a4a4a;
    }

    .toggle-arrow {
        font-size: 10px;
        transition: transform 0.3s ease;
    }

    .toggle-arrow.expanded {
        transform: rotate(180deg);
    }

    /* Collapsible Content */
    .disclosure-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.4s ease-out;
        text-align: left;
    }

    .disclosure-content.expanded {
        max-height: 3000px;
        transition: max-height 0.6s ease-in;
    }

    .medical-disclaimer,
    .methodology-disclaimer,
    .affiliate-disclaimer,
    .privacy-disclaimer,
    .limitations-disclaimer,
    .terms-summary,
    .contact-disclaimer {
        margin-bottom: 15px;
        padding: 15px 0;
        border-bottom: 1px solid #2a2a2a;
    }

    /* Footer Section */
    .footer-section {
        border-top: 1px solid #3a3a3a;
        padding-top: 20px;
        margin-top: 30px;
        text-align: center;
    }

    .footer-section a {
        text-decoration: none;
    }

    .footer-section a:hover {
        text-decoration: underline;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
        .legal-disclosures-section {
            margin-top: 40px;
            padding: 30px 0;
        }
        
        .disclosures-content {
            padding: 0 15px;
        }
        
        .disclaimer-title {
            font-size: 16px;
        }
        
        .section-subtitle {
            font-size: 13px;
        }
        
        .disclaimer-text {
            font-size: 11px;
        }
        
        .primary-disclaimer .disclaimer-text {
            font-size: 12px;
        }
        
        .disclosure-toggle {
            padding: 14px 18px;
            font-size: 12px;
            width: 100%;
            max-width: 300px;
        }
        
        .toggle-arrow {
            font-size: 10px;
        }
    }

    /* Print Styles */
    @media print {
        .legal-disclosures-section {
            background-color: white !important;
            color: black !important;
        }
        
        .disclaimer-text,
        .section-subtitle,
        .disclaimer-title {
            color: black !important;
        }
        
        .disclosure-content {
            max-height: none !important;
            overflow: visible !important;
        }
        
        .disclosure-toggle {
            display: none;
        }
    }
    </style>

    <script>
    function toggleDisclosure() {
        const content = document.getElementById('disclosureContent');
        const arrow = document.getElementById('toggleArrow');
        const toggleText = document.getElementById('toggleText');
        
        if (content.classList.contains('expanded')) {
            // Close the disclosure
            content.classList.remove('expanded');
            arrow.classList.remove('expanded');
            toggleText.textContent = 'View Complete Disclaimer';
        } else {
            // Open the disclosure
            content.classList.add('expanded');
            arrow.classList.add('expanded');
            toggleText.textContent = 'Hide Complete Disclaimer';
        }
    }
    </script>

    <!-- LEGAL INFORMATION MODAL (Only what's NOT in the disclaimer) -->
    <div id="legal-modal" class="info-modal" style="display: none;">
        <div class="modal-overlay" onclick="closeLegalModal()"></div>
        <div class="modal-content">
            <button class="modal-close" onclick="closeLegalModal()">×</button>
            
            <h1 style="font-family: Georgia, serif; font-size: 22px; margin-bottom: 20px; text-align: center;">Additional Legal Terms</h1>
            
            <p style="font-size: 12px; line-height: 1.5; margin-bottom: 20px; color: #cccccc; text-align: center;">
                These terms supplement our comprehensive disclosure statement below. For full medical disclaimers, affiliate disclosures, and privacy information, please see the "Click for Full Disclosure Statement" section on this page.
            </p>
            
            <!-- Service Usage Restrictions -->
            <h2 class="modal-section-title">Service Usage Restrictions</h2>
            <div class="modal-text">
                <strong>No Automated Data Extraction:</strong> You may not use automated systems, bots, or scraping tools to extract data from Days by Diet, or integrate this service into third-party applications without written permission.
                <br><br>
                <strong>Service Modifications:</strong> We reserve the right to modify, suspend, or discontinue any aspect of the service at any time without prior notice. We may also update these terms without notice; continued use constitutes acceptance of changes.
                <br><br>
                <strong>Personal Use Only:</strong> This tool is provided for personal, non-commercial educational purposes. You may not use it to provide health advice to others or represent it as a professional medical tool.
            </div>
            
            <!-- Governing Law & Jurisdiction -->
            <h2 class="modal-section-title">Governing Law & Jurisdiction</h2>
            <div class="modal-text">
                <strong>New Zealand Law:</strong> This agreement and your use of Days by Diet are governed by the laws of New Zealand, without regard to conflict of law principles. Any disputes arising from your use of this service shall be subject to the exclusive jurisdiction of the courts of New Zealand.
                <br><br>
                <strong>International Users:</strong> By accessing this service from outside New Zealand, you acknowledge that you are doing so at your own initiative and are responsible for compliance with your local laws and regulations.
            </div>
            
            <!-- Business Information -->
            <h2 class="modal-section-title">Business Information</h2>
            <div class="modal-text">
                <strong>Legal Entity:</strong><br>
                Blue and Ginge Creative Ltd<br>
                13 Hargreaves Street<br>
                Auckland, New Zealand 1011
                <br><br>
                <strong>For Questions or Concerns:</strong> Please use the contact form available via the "Contact" link at the bottom of this page.
            </div>
            
            <!-- Severability -->
            <h2 class="modal-section-title">Severability</h2>
            <div class="modal-text">
                If any provision of these terms is found to be invalid or unenforceable by a court of competent jurisdiction, the remaining provisions shall continue in full force and effect.
            </div>
            
            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #4a4a4a;">
                <button 
                    onclick="closeLegalModal()"
                    style="background-color: #660000; color: white; border: none; padding: 10px 30px; border-radius: 4px; font-size: 13px; cursor: pointer; font-family: 'Poppins', sans-serif;"
                    onmouseover="this.style.backgroundColor='#aa0000'"
                    onmouseout="this.style.backgroundColor='#660000'"
                >
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- CONTACT MODAL -->
    <div id="contact-modal" class="info-modal" style="display: none;">
        <div class="modal-overlay" onclick="closeContactModal()"></div>
        <div class="modal-content">
            <button class="modal-close" onclick="closeContactModal()">×</button>
            <h2 style="font-family: Georgia, serif; margin-bottom: 15px; text-align: center;">Contact Days by Diet</h2>
            
            <p style="font-size: 13px; line-height: 1.5; margin-bottom: 20px; color: #cccccc; text-align: center;">
                We welcome your questions and feedback about our health awareness tool.
            </p>
            
            <!-- Contact Form -->
            <form id="contact-form" onsubmit="handleContactSubmit(event)">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; font-size: 12px; font-weight: 500; margin-bottom: 5px; color: #ffffff;">
                        Name: <span style="color: #cc8888;">*</span>
                    </label>
                    <input 
                        type="text" 
                        id="contact-name" 
                        name="name"
                        required
                        style="width: 100%; padding: 10px; background-color: #1a1a1a; border: 1px solid #4a4a4a; border-radius: 4px; color: #ffffff; font-size: 13px; font-family: 'Poppins', sans-serif; box-sizing: border-box;"
                        placeholder="Your name"
                    >
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; font-size: 12px; font-weight: 500; margin-bottom: 5px; color: #ffffff;">
                        Email Address: <span style="color: #cc8888;">*</span>
                    </label>
                    <input 
                        type="email" 
                        id="contact-email" 
                        name="email"
                        required
                        style="width: 100%; padding: 10px; background-color: #1a1a1a; border: 1px solid #4a4a4a; border-radius: 4px; color: #ffffff; font-size: 13px; font-family: 'Poppins', sans-serif; box-sizing: border-box;"
                        placeholder="your.email@example.com"
                    >
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-size: 12px; font-weight: 500; margin-bottom: 5px; color: #ffffff;">
                        Message: <span style="color: #cc8888;">*</span>
                    </label>
                    <textarea 
                        id="contact-message" 
                        name="message"
                        required
                        rows="5"
                        style="width: 100%; padding: 10px; background-color: #1a1a1a; border: 1px solid #4a4a4a; border-radius: 4px; color: #ffffff; font-size: 13px; font-family: 'Poppins', sans-serif; resize: vertical; box-sizing: border-box;"
                        placeholder="How can we help you?"
                    ></textarea>
                </div>
                
                <div style="margin-bottom: 20px; padding: 12px; background-color: #3a3a3a; border-radius: 4px; font-size: 11px; color: #aaaaaa;">
                    <strong style="color: #ffffff;">Note:</strong> We cannot provide personal medical advice. For health concerns, please consult qualified healthcare professionals or use our partner services for personalized guidance.
                </div>
                
                <button 
                    type="submit" 
                    id="submit-btn"
                    style="width: 100%; padding: 12px; background-color: #660000; color: white; border: none; border-radius: 4px; font-size: 14px; font-weight: 600; cursor: pointer; font-family: 'Poppins', sans-serif; transition: background-color 0.3s;"
                    onmouseover="this.style.backgroundColor='#aa0000'"
                    onmouseout="this.style.backgroundColor='#660000'"
                >
                    Send Message
                </button>
                
                <div id="form-status" style="margin-top: 15px; font-size: 12px; text-align: center;"></div>
            </form>
            
            <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid #4a4a4a; font-size: 11px; color: #888888; text-align: center;">
                <strong style="color: #ffffff;">Blue and Ginge Creative Ltd</strong><br>
                13 Hargreaves Street, Auckland, New Zealand 1011<br>
                Response time: Within 48 hours
            </div>
        </div>
    </div>

    <!-- MODAL STYLING -->
    <style>
    /* Modal Base Styles */
    .info-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 10000;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    .modal-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.85);
        backdrop-filter: blur(3px);
    }

    .modal-content {
        position: relative;
        background-color: #2a2a2a;
        border: 1px solid #4a4a4a;
        border-radius: 8px;
        padding: 35px;
        max-width: 600px;
        width: 100%;
        max-height: 85vh;
        overflow-y: auto;
        z-index: 10001;
        color: #ffffff;
        font-family: 'Poppins', sans-serif;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .modal-close {
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        color: #888888;
        font-size: 32px;
        cursor: pointer;
        line-height: 1;
        padding: 0;
        width: 35px;
        height: 35px;
        transition: color 0.2s;
        z-index: 10002;
    }

    .modal-close:hover {
        color: #ffffff;
    }

    .modal-section-title {
        font-family: 'Georgia', serif;
        font-size: 16px;
        margin-top: 25px;
        margin-bottom: 12px;
        color: #ffffff;
        border-bottom: 1px solid #4a4a4a;
        padding-bottom: 8px;
    }

    .modal-text {
        font-size: 12px;
        line-height: 1.6;
        color: #cccccc;
        margin-bottom: 15px;
    }

    .modal-text strong {
        color: #ffffff;
        font-weight: 600;
    }

    /* Custom Scrollbar for Modals */
    .modal-content::-webkit-scrollbar {
        width: 8px;
    }

    .modal-content::-webkit-scrollbar-track {
        background: #1a1a1a;
        border-radius: 4px;
    }

    .modal-content::-webkit-scrollbar-thumb {
        background: #4a4a4a;
        border-radius: 4px;
    }

    .modal-content::-webkit-scrollbar-thumb:hover {
        background: #666666;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
        .info-modal {
            padding: 10px;
        }
        
        .modal-content {
            padding: 25px 20px;
            max-width: 100%;
            max-height: 90vh;
        }
        
        .modal-close {
            top: 10px;
            right: 10px;
            font-size: 28px;
        }
        
        .modal-section-title {
            font-size: 15px;
        }
        
        .modal-text {
            font-size: 11px;
        }
    }

    /* Prevent body scroll when modal open */
    body.modal-open {
        overflow: hidden;
    }
    </style>

    <!-- MODAL JAVASCRIPT -->
    <script>
    // Legal Modal Functions
    function showLegalModal() {
        document.getElementById('legal-modal').style.display = 'flex';
        document.body.classList.add('modal-open');
    }

    function closeLegalModal() {
        document.getElementById('legal-modal').style.display = 'none';
        document.body.classList.remove('modal-open');
    }

    // Contact Modal Functions
    function showContactModal() {
        document.getElementById('contact-modal').style.display = 'flex';
        document.body.classList.add('modal-open');
    }

    function closeContactModal() {
        document.getElementById('contact-modal').style.display = 'none';
        document.body.classList.remove('modal-open');
        // Reset form
        document.getElementById('contact-form').reset();
        document.getElementById('form-status').innerHTML = '';
    }

    // Handle Contact Form Submission
    function handleContactSubmit(event) {
        event.preventDefault();
        
        const name = document.getElementById('contact-name').value;
        const email = document.getElementById('contact-email').value;
        const message = document.getElementById('contact-message').value;
        const submitBtn = document.getElementById('submit-btn');
        const formStatus = document.getElementById('form-status');
        
        // Disable submit button
        submitBtn.disabled = true;
        submitBtn.textContent = 'Sending...';
        submitBtn.style.backgroundColor = '#444444';
        
        // OPTION 1: Simple mailto (works immediately - REPLACE EMAIL ADDRESS)
        const subject = encodeURIComponent('Days by Diet Contact Form');
        const body = encodeURIComponent(
            `Name: ${name}\n` +
            `Email: ${email}\n\n` +
            `Message:\n${message}\n\n` +
            `---\n` +
            `Sent from Days by Diet contact form`
        );
        
        window.location.href = `mailto:contact@daysbydiet.com?subject=${subject}&body=${body}`;
        
        formStatus.innerHTML = '<span style="color: #88cc88;">✓ Opening your email client...</span>';
        
        setTimeout(() => {
            submitBtn.disabled = false;
            submitBtn.textContent = 'Send Message';
            submitBtn.style.backgroundColor = '#660000';
        }, 3000);
        
        /* 
        // OPTION 2: Formspree Integration (Better user experience)
        // Sign up at https://formspree.io (free 50 submissions/month)
        // Create a form and replace YOUR-FORM-ID below
        
        fetch('https://formspree.io/f/YOUR-FORM-ID', {
            method: 'POST',
            body: new FormData(event.target),
            headers: {
                'Accept': 'application/json'
            }
        })
        .then(response => {
            if (response.ok) {
                formStatus.innerHTML = '<span style="color: #88cc88;">✓ Message sent successfully! We\'ll respond within 48 hours.</span>';
                document.getElementById('contact-form').reset();
            } else {
                throw new Error('Form submission failed');
            }
        })
        .catch(error => {
            formStatus.innerHTML = '<span style="color: #cc8888;">✗ Error sending. Please try again.</span>';
        })
        .finally(() => {
            submitBtn.disabled = false;
            submitBtn.textContent = 'Send Message';
            submitBtn.style.backgroundColor = '#660000';
        });
        */
    }

    // Close modals on Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeLegalModal();
            closeContactModal();
        }
    });

    // Prevent modal content clicks from closing modal
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.modal-content').forEach(content => {
            content.addEventListener('click', function(e) {
                e.stopPropagation();
            });
        });
    });
    </script>
     
</body>
</html>